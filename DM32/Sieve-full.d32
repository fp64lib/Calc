#
# Sieve-full.d32 - Fast prime detection using Sieve of Eratosthenes 
# (C) 2023-2026 Uwe Bissinger
#
# This set of routines takes advantage of the 900 available
# local registers to implement a several functions to detect
# whether a number is prime or not.
#
# See Sieve.d32 for details & documentation, this is the version with
# pre-initialized registers.

# STACK

# REGS
RJ: 999.998

# EREGS
R100: 2
R101: 3
R102: 5
R103: 7
R104: 11
R105: 13
R106: 17
R107: 19
R108: 23
R109: 29
R110: 31
R111: 37
R112: 41
R113: 43
R114: 47
R115: 53
R116: 59
R117: 61
R118: 67
R119: 71
R120: 73
R121: 79
R122: 83
R123: 89
R124: 97
R125: 101
R126: 103
R127: 107
R128: 109
R129: 113
R130: 127
R131: 131
R132: 137
R133: 139
R134: 149
R135: 151
R136: 157
R137: 163
R138: 167
R139: 173
R140: 179
R141: 181
R142: 191
R143: 193
R144: 197
R145: 199
R146: 211
R147: 223
R148: 227
R149: 229
R150: 233
R151: 239
R152: 241
R153: 251
R154: 257
R155: 263
R156: 269
R157: 271
R158: 277
R159: 281
R160: 283
R161: 293
R162: 307
R163: 311
R164: 313
R165: 317
R166: 331
R167: 337
R168: 347
R169: 349
R170: 353
R171: 359
R172: 367
R173: 373
R174: 379
R175: 383
R176: 389
R177: 397
R178: 401
R179: 409
R180: 419
R181: 421
R182: 431
R183: 433
R184: 439
R185: 443
R186: 449
R187: 457
R188: 461
R189: 463
R190: 467
R191: 479
R192: 487
R193: 491
R194: 499
R195: 503
R196: 509
R197: 521
R198: 523
R199: 541
R200: 547
R201: 557
R202: 563
R203: 569
R204: 571
R205: 577
R206: 587
R207: 593
R208: 599
R209: 601
R210: 607
R211: 613
R212: 617
R213: 619
R214: 631
R215: 641
R216: 643
R217: 647
R218: 653
R219: 659
R220: 661
R221: 673
R222: 677
R223: 683
R224: 691
R225: 701
R226: 709
R227: 719
R228: 727
R229: 733
R230: 739
R231: 743
R232: 751
R233: 757
R234: 761
R235: 769
R236: 773
R237: 787
R238: 797
R239: 809
R240: 811
R241: 821
R242: 823
R243: 827
R244: 829
R245: 839
R246: 853
R247: 857
R248: 859
R249: 863
R250: 877
R251: 881
R252: 883
R253: 887
R254: 907
R255: 911
R256: 919
R257: 929
R258: 937
R259: 941
R260: 947
R261: 953
R262: 967
R263: 971
R264: 977
R265: 983
R266: 991
R267: 997
R268: 1009
R269: 1013
R270: 1019
R271: 1021
R272: 1031
R273: 1033
R274: 1039
R275: 1049
R276: 1051
R277: 1061
R278: 1063
R279: 1069
R280: 1087
R281: 1091
R282: 1093
R283: 1097
R284: 1103
R285: 1109
R286: 1117
R287: 1123
R288: 1129
R289: 1151
R290: 1153
R291: 1163
R292: 1171
R293: 1181
R294: 1187
R295: 1193
R296: 1201
R297: 1213
R298: 1217
R299: 1223
R300: 1229
R301: 1231
R302: 1237
R303: 1249
R304: 1259
R305: 1277
R306: 1279
R307: 1283
R308: 1289
R309: 1291
R310: 1297
R311: 1301
R312: 1303
R313: 1307
R314: 1319
R315: 1321
R316: 1327
R317: 1361
R318: 1367
R319: 1373
R320: 1381
R321: 1399
R322: 1409
R323: 1423
R324: 1427
R325: 1429
R326: 1433
R327: 1439
R328: 1447
R329: 1451
R330: 1453
R331: 1459
R332: 1471
R333: 1481
R334: 1483
R335: 1487
R336: 1489
R337: 1493
R338: 1499
R339: 1511
R340: 1523
R341: 1531
R342: 1543
R343: 1549
R344: 1553
R345: 1559
R346: 1567
R347: 1571
R348: 1579
R349: 1583
R350: 1597
R351: 1601
R352: 1607
R353: 1609
R354: 1613
R355: 1619
R356: 1621
R357: 1627
R358: 1637
R359: 1657
R360: 1663
R361: 1667
R362: 1669
R363: 1693
R364: 1697
R365: 1699
R366: 1709
R367: 1721
R368: 1723
R369: 1733
R370: 1741
R371: 1747
R372: 1753
R373: 1759
R374: 1777
R375: 1783
R376: 1787
R377: 1789
R378: 1801
R379: 1811
R380: 1823
R381: 1831
R382: 1847
R383: 1861
R384: 1867
R385: 1871
R386: 1873
R387: 1877
R388: 1879
R389: 1889
R390: 1901
R391: 1907
R392: 1913
R393: 1931
R394: 1933
R395: 1949
R396: 1951
R397: 1973
R398: 1979
R399: 1987
R400: 1993
R401: 1997
R402: 1999
R403: 2003
R404: 2011
R405: 2017
R406: 2027
R407: 2029
R408: 2039
R409: 2053
R410: 2063
R411: 2069
R412: 2081
R413: 2083
R414: 2087
R415: 2089
R416: 2099
R417: 2111
R418: 2113
R419: 2129
R420: 2131
R421: 2137
R422: 2141
R423: 2143
R424: 2153
R425: 2161
R426: 2179
R427: 2203
R428: 2207
R429: 2213
R430: 2221
R431: 2237
R432: 2239
R433: 2243
R434: 2251
R435: 2267
R436: 2269
R437: 2273
R438: 2281
R439: 2287
R440: 2293
R441: 2297
R442: 2309
R443: 2311
R444: 2333
R445: 2339
R446: 2341
R447: 2347
R448: 2351
R449: 2357
R450: 2371
R451: 2377
R452: 2381
R453: 2383
R454: 2389
R455: 2393
R456: 2399
R457: 2411
R458: 2417
R459: 2423
R460: 2437
R461: 2441
R462: 2447
R463: 2459
R464: 2467
R465: 2473
R466: 2477
R467: 2503
R468: 2521
R469: 2531
R470: 2539
R471: 2543
R472: 2549
R473: 2551
R474: 2557
R475: 2579
R476: 2591
R477: 2593
R478: 2609
R479: 2617
R480: 2621
R481: 2633
R482: 2647
R483: 2657
R484: 2659
R485: 2663
R486: 2671
R487: 2677
R488: 2683
R489: 2687
R490: 2689
R491: 2693
R492: 2699
R493: 2707
R494: 2711
R495: 2713
R496: 2719
R497: 2729
R498: 2731
R499: 2741
R500: 2749
R501: 2753
R502: 2767
R503: 2777
R504: 2789
R505: 2791
R506: 2797
R507: 2801
R508: 2803
R509: 2819
R510: 2833
R511: 2837
R512: 2843
R513: 2851
R514: 2857
R515: 2861
R516: 2879
R517: 2887
R518: 2897
R519: 2903
R520: 2909
R521: 2917
R522: 2927
R523: 2939
R524: 2953
R525: 2957
R526: 2963
R527: 2969
R528: 2971
R529: 2999
R530: 3001
R531: 3011
R532: 3019
R533: 3023
R534: 3037
R535: 3041
R536: 3049
R537: 3061
R538: 3067
R539: 3079
R540: 3083
R541: 3089
R542: 3109
R543: 3119
R544: 3121
R545: 3137
R546: 3163
R547: 3167
R548: 3169
R549: 3181
R550: 3187
R551: 3191
R552: 3203
R553: 3209
R554: 3217
R555: 3221
R556: 3229
R557: 3251
R558: 3253
R559: 3257
R560: 3259
R561: 3271
R562: 3299
R563: 3301
R564: 3307
R565: 3313
R566: 3319
R567: 3323
R568: 3329
R569: 3331
R570: 3343
R571: 3347
R572: 3359
R573: 3361
R574: 3371
R575: 3373
R576: 3389
R577: 3391
R578: 3407
R579: 3413
R580: 3433
R581: 3449
R582: 3457
R583: 3461
R584: 3463
R585: 3467
R586: 3469
R587: 3491
R588: 3499
R589: 3511
R590: 3517
R591: 3527
R592: 3529
R593: 3533
R594: 3539
R595: 3541
R596: 3547
R597: 3557
R598: 3559
R599: 3571
R600: 3581
R601: 3583
R602: 3593
R603: 3607
R604: 3613
R605: 3617
R606: 3623
R607: 3631
R608: 3637
R609: 3643
R610: 3659
R611: 3671
R612: 3673
R613: 3677
R614: 3691
R615: 3697
R616: 3701
R617: 3709
R618: 3719
R619: 3727
R620: 3733
R621: 3739
R622: 3761
R623: 3767
R624: 3769
R625: 3779
R626: 3793
R627: 3797
R628: 3803
R629: 3821
R630: 3823
R631: 3833
R632: 3847
R633: 3851
R634: 3853
R635: 3863
R636: 3877
R637: 3881
R638: 3889
R639: 3907
R640: 3911
R641: 3917
R642: 3919
R643: 3923
R644: 3929
R645: 3931
R646: 3943
R647: 3947
R648: 3967
R649: 3989
R650: 4001
R651: 4003
R652: 4007
R653: 4013
R654: 4019
R655: 4021
R656: 4027
R657: 4049
R658: 4051
R659: 4057
R660: 4073
R661: 4079
R662: 4091
R663: 4093
R664: 4099
R665: 4111
R666: 4127
R667: 4129
R668: 4133
R669: 4139
R670: 4153
R671: 4157
R672: 4159
R673: 4177
R674: 4201
R675: 4211
R676: 4217
R677: 4219
R678: 4229
R679: 4231
R680: 4241
R681: 4243
R682: 4253
R683: 4259
R684: 4261
R685: 4271
R686: 4273
R687: 4283
R688: 4289
R689: 4297
R690: 4327
R691: 4337
R692: 4339
R693: 4349
R694: 4357
R695: 4363
R696: 4373
R697: 4391
R698: 4397
R699: 4409
R700: 4421
R701: 4423
R702: 4441
R703: 4447
R704: 4451
R705: 4457
R706: 4463
R707: 4481
R708: 4483
R709: 4493
R710: 4507
R711: 4513
R712: 4517
R713: 4519
R714: 4523
R715: 4547
R716: 4549
R717: 4561
R718: 4567
R719: 4583
R720: 4591
R721: 4597
R722: 4603
R723: 4621
R724: 4637
R725: 4639
R726: 4643
R727: 4649
R728: 4651
R729: 4657
R730: 4663
R731: 4673
R732: 4679
R733: 4691
R734: 4703
R735: 4721
R736: 4723
R737: 4729
R738: 4733
R739: 4751
R740: 4759
R741: 4783
R742: 4787
R743: 4789
R744: 4793
R745: 4799
R746: 4801
R747: 4813
R748: 4817
R749: 4831
R750: 4861
R751: 4871
R752: 4877
R753: 4889
R754: 4903
R755: 4909
R756: 4919
R757: 4931
R758: 4933
R759: 4937
R760: 4943
R761: 4951
R762: 4957
R763: 4967
R764: 4969
R765: 4973
R766: 4987
R767: 4993
R768: 4999
R769: 5003
R770: 5009
R771: 5011
R772: 5021
R773: 5023
R774: 5039
R775: 5051
R776: 5059
R777: 5077
R778: 5081
R779: 5087
R780: 5099
R781: 5101
R782: 5107
R783: 5113
R784: 5119
R785: 5147
R786: 5153
R787: 5167
R788: 5171
R789: 5179
R790: 5189
R791: 5197
R792: 5209
R793: 5227
R794: 5231
R795: 5233
R796: 5237
R797: 5261
R798: 5273
R799: 5279
R800: 5281
R801: 5297
R802: 5303
R803: 5309
R804: 5323
R805: 5333
R806: 5347
R807: 5351
R808: 5381
R809: 5387
R810: 5393
R811: 5399
R812: 5407
R813: 5413
R814: 5417
R815: 5419
R816: 5431
R817: 5437
R818: 5441
R819: 5443
R820: 5449
R821: 5471
R822: 5477
R823: 5479
R824: 5483
R825: 5501
R826: 5503
R827: 5507
R828: 5519
R829: 5521
R830: 5527
R831: 5531
R832: 5557
R833: 5563
R834: 5569
R835: 5573
R836: 5581
R837: 5591
R838: 5623
R839: 5639
R840: 5641
R841: 5647
R842: 5651
R843: 5653
R844: 5657
R845: 5659
R846: 5669
R847: 5683
R848: 5689
R849: 5693
R850: 5701
R851: 5711
R852: 5717
R853: 5737
R854: 5741
R855: 5743
R856: 5749
R857: 5779
R858: 5783
R859: 5791
R860: 5801
R861: 5807
R862: 5813
R863: 5821
R864: 5827
R865: 5839
R866: 5843
R867: 5849
R868: 5851
R869: 5857
R870: 5861
R871: 5867
R872: 5869
R873: 5879
R874: 5881
R875: 5897
R876: 5903
R877: 5923
R878: 5927
R879: 5939
R880: 5953
R881: 5981
R882: 5987
R883: 6007
R884: 6011
R885: 6029
R886: 6037
R887: 6043
R888: 6047
R889: 6053
R890: 6067
R891: 6073
R892: 6079
R893: 6089
R894: 6091
R895: 6101
R896: 6113
R897: 6121
R898: 6131
R899: 6133
R900: 6143
R901: 6151
R902: 6163
R903: 6173
R904: 6197
R905: 6199
R906: 6203
R907: 6211
R908: 6217
R909: 6221
R910: 6229
R911: 6247
R912: 6257
R913: 6263
R914: 6269
R915: 6271
R916: 6277
R917: 6287
R918: 6299
R919: 6301
R920: 6311
R921: 6317
R922: 6323
R923: 6329
R924: 6337
R925: 6343
R926: 6353
R927: 6359
R928: 6361
R929: 6367
R930: 6373
R931: 6379
R932: 6389
R933: 6397
R934: 6421
R935: 6427
R936: 6449
R937: 6451
R938: 6469
R939: 6473
R940: 6481
R941: 6491
R942: 6521
R943: 6529
R944: 6547
R945: 6551
R946: 6553
R947: 6563
R948: 6569
R949: 6571
R950: 6577
R951: 6581
R952: 6599
R953: 6607
R954: 6619
R955: 6637
R956: 6653
R957: 6659
R958: 6661
R959: 6673
R960: 6679
R961: 6689
R962: 6691
R963: 6701
R964: 6703
R965: 6709
R966: 6719
R967: 6733
R968: 6737
R969: 6761
R970: 6763
R971: 6779
R972: 6781
R973: 6791
R974: 6793
R975: 6803
R976: 6823
R977: 6827
R978: 6829
R979: 6833
R980: 6841
R981: 6857
R982: 6863
R983: 6869
R984: 6871
R985: 6883
R986: 6899
R987: 6907
R988: 6911
R989: 6917
R990: 6947
R991: 6949
R992: 6959
R993: 6961
R994: 6967
R995: 6971
R996: 6977
R997: 6983
R998: 6991
R999: 6997

# FLAGS

# SEED

# MODE
MFMT: FIX 4

# EQUATION LIST

# PROGRAM
PTR: 0
PGM
  LBL I
  100.998
  STO J
  STO i
  2
  STO\blpar;i\brpar;
  ISG i
  3
  STO\blpar;i\brpar;
  STO P
  RCL i
  STO J
  LBL A
  2
  STO+ P
  RCL J
  IP
  1E3
  \div;
  101
  +
  STO i
  LBL L
  RCL P
  RCL\blpar;i\brpar;
  x\sqr;
  x>y?
  GTO M
  CLx
  RCL\blpar;i\brpar;
  \div;
  FP
  x=0?
  GTO A
  ISG i
  GTO L
  LBL M
  1
  RCL+ J
  STO i
  RCL P
  STO\blpar;i\brpar;
  ISG J
  GTO A
  RTN
  LBL P
  STO P
  7E3
  x\sqr;
  CF 0
  x<y?
  SF 0
  100.999
  STO i
  LBL C
  RCL P
  RCL\blpar;i\brpar;
  x\sqr;
  x>y?
  GTO F
  CLx
  RCL\blpar;i\brpar;
  \div;
  FP
  x=0?
  RTN
  ISG i
  GTO C
  FS? 0
  GTO D
  LBL F
  1
  RTN
  LBL D
  6999
  STO i
  LBL E
  2
  STO+ i
  RCL P
  RCL i
  x\sqr;
  x>y?
  GTO F
  CLx
  RCL i
  \div;
  FP
  x\neq;0?
  GTO E
  RTN
  LBL N
  2
  +
  LBL S
  XEQ P
  RCL P
  +
  RCL P
  x\neq;y?
  RTN
  GTO N
PGMEND
